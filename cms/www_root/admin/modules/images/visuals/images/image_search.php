<?php	// No direct access	defined('_ACCESS') or die;		require_once "libraries/system/template_engine.php";		class ImageSearch extends Visual {			private static $TEMPLATE = "images/images/image_search.tpl";		private static $TITLE_SEARCH_KEY = "s_title";		private static $FILENAME_SEARCH_KEY = "s_filename";		private static $LABEL_SEARCH_KEY = "s_label";				private $_template_engine;		private $_image_dao;			public function __construct() {			$this->_image_dao = ImageDao::getInstance();			$this->_template_engine = TemplateEngine::getInstance();		}			public function render() {			$this->_template_engine->assign("title_search_field", $this->getTitleSearchField()->render());			$this->_template_engine->assign("filename_search_field", $this->getFileNameSearchField()->render());			$this->_template_engine->assign("labels_search_field", $this->getLabelPullDown()->render());			$this->_template_engine->assign("search_button", $this->getSearchButton()->render());							return $this->_template_engine->fetch("modules/" . self::$TEMPLATE);		}				private function getTitleSearchField() {			$title_search_field = new TextField("s_title", "Titel", $this->getTitleSearchQueryString(), false, false, null);			return $title_search_field;		}				private function getFileNameSearchField() {			$filename_search_field = new TextField("s_filename", "Bestandsnaam", $this->getFileNameSearchQueryString(), false, false, null);			return $filename_search_field;		}				private function getLabelPullDown() {			$labels = $this->getLabels();			$currently_selected_label = $this->getLabelSearchQueryString();			$labels_pulldown = new PullDown("s_label", "Label", (is_null($currently_selected_label) ? null : $currently_selected_label), $labels, false, "");			return $labels_pulldown;		}				private function getSearchButton() {			$search_button = new Button("", "Zoeken", "document.getElementById('image_search').submit(); return false;");			return $search_button;		}				private function getTitleSearchQueryString() {			return $this->getQueryStringValue("s_title");		}				private function getFileNameSearchQueryString() {			return $this->getQueryStringValue("s_filename");		}				private function getLabelSearchQueryString() {			return $this->getQueryStringValue("s_label");		}				private function getQueryStringValue($query_string_key) {			$label = null;			if (isset($_GET[$query_string_key]) && $_GET[$query_string_key] != "") {				$label = $_GET[$query_string_key];			}			return $label;		}				private function getLabels() {			$labels_name_value_pair = array();			$labels_name_value_pair[] = array('name' => '&gt; Selecteer', 'value' => null);			foreach ($this->_image_dao->getAllLabels() as $label) {				$labels_name_value_pair[] = array('name' => $label->getName(), 'value' => $label->getId());			}			return $labels_name_value_pair;		}	}	?>