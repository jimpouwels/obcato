<?php	// No direct access	defined('_ACCESS') or die;		require_once "libraries/system/template_engine.php";		class ImageSearch extends Visual {			private static $TEMPLATE = "images/images/image_search.tpl";				private $_template_engine;		private $_image_dao;		private $_images_pre_handler;			public function __construct($images_pre_handler) {			$this->_image_dao = ImageDao::getInstance();			$this->_template_engine = TemplateEngine::getInstance();			$this->_images_pre_handler = $images_pre_handler;		}			public function render() {			$this->_template_engine->assign("title_search_field", $this->getTitleSearchField()->render());			$this->_template_engine->assign("filename_search_field", $this->getFileNameSearchField()->render());			$this->_template_engine->assign("labels_search_field", $this->getLabelPullDown()->render());			$this->_template_engine->assign("search_button", $this->getSearchButton()->render());							return $this->_template_engine->fetch("modules/" . self::$TEMPLATE);		}				private function getTitleSearchField() {			$title_search_field = new TextField("s_title", "Titel", $this->_images_pre_handler->getCurrentSearchTitleFromGetRequest(), false, false, null);			return $title_search_field;		}				private function getFileNameSearchField() {			$filename_search_field = new TextField("s_filename", "Bestandsnaam", $this->_images_pre_handler->getCurrentSearchFilenameFromGetRequest(), false, false, null);			return $filename_search_field;		}				private function getLabelPullDown() {			$labels = $this->getLabels();			$currently_selected_label = $this->_images_pre_handler->getCurrentSearchLabelFromGetRequest();			$labels_pulldown = new PullDown("s_label", "Label", (is_null($currently_selected_label) ? null : $currently_selected_label), $labels, false, "");			return $labels_pulldown;		}				private function getSearchButton() {			$search_button = new Button("", "Zoeken", "document.getElementById('image_search').submit(); return false;");			return $search_button;		}				private function getLabels() {			$labels_name_value_pair = array();			$labels_name_value_pair[] = array('name' => '&gt; Selecteer', 'value' => null);			foreach ($this->_image_dao->getAllLabels() as $label) {				$labels_name_value_pair[] = array('name' => $label->getName(), 'value' => $label->getId());			}			return $labels_name_value_pair;		}	}	?>